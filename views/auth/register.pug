extends ../layout

block content
  - var page = 'register' // <-- 1. Se define la variable 'page'

  .row.justify-content-center.mt-5
    .col-md-4
      .card
        .card-body
          h3.card-title.text-center
            | Registro de Nuevo Usuario
          
          form(action="/register", method="POST")
            .mb-3
              label.form-label(for="nombre") Nombre
              input.form-control(type="text", id="nombre", name="nombre", required)
            .mb-3
              label.form-label(for="apellido") Apellido
              input.form-control(type="text", id="apellido", name="apellido", required)
            .mb-3
              label.form-label(for="username") Nombre de Usuario
              input.form-control(type="text", id="username", name="username", required)
            .mb-3
              label.form-label(for="email") Email
              input.form-control(type="email", id="email", name="email", required)
            
            // --- 2. MODIFICACIÓN PARA EL BOTÓN ---
            .mb-3
              label.form-label(for="password") Contraseña
              .input-group
                input.form-control(type="password", id="password", name="password", required)
                button.btn.btn-outline-secondary(type="button", id="togglePassword")
                  i.fas.fa-eye(id="toggleIcon")
            // --- FIN DE LA MODIFICACIÓN ---

            .d-grid
              button.btn.btn-success(type="submit") Registrarse

          .text-center.mt-3
            a(href="/login") ¿Ya tienes cuenta? Inicia Sesión

  // --- 3. SCRIPT (AHORA DENTRO DE BLOCK CONTENT) ---
  script.
    document.addEventListener('DOMContentLoaded', () => {
      const toggleButton = document.getElementById('togglePassword');
      const passwordInput = document.getElementById('password');
      const icon = document.getElementById('toggleIcon');

      if (toggleButton && passwordInput && icon) {
        toggleButton.addEventListener('click', () => {
          const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
          passwordInput.setAttribute('type', type);
          
          if (type === 'password') {
            icon.classList.remove('fa-eye-slash');
            icon.classList.add('fa-eye');
          } else {
            icon.classList.remove('fa-eye');
            icon.classList.add('fa-eye-slash');
          }
        });
      }
    });